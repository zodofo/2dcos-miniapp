<view class="container">

<!-- 文件选择与参数设置 -->
<view class="section">
  <button type="default" bindtap="pickFile">选择 Excel 文件</button>
  <text style="margin-left:10px;">{{fileName}}</text>
</view>

<view class="section">
  <text>表头行索引：</text>
  <input type="number" value="{{header_row}}" bindinput="onHeaderRow" style="border:1px solid #ccc; width:100px;"/>
</view>

<view class="section">
  <text>使用相关系数(Z-score)：</text>
  <switch checked="{{use_std}}" bindchange="onUseStd"/>
</view>

<view class="section">
  <text>高斯平滑 σ：</text>
  <slider min="0" max="5" step="1" show-value value="{{sigma}}" bindchange="onSigma"/>
</view>

<!-- 提交按钮 -->
<view class="section">
  <button type="primary" bindtap="startAnalyze" loading="{{loading}}" disabled="{{!tempFilePath}}">
    开始分析
  </button>
</view>

<!-- 分析结果展示 -->
<view wx:if="{{syncPath}}" class="section">
  <text>同步二维相关光谱</text>
  <image class="result-img" src="{{syncPath}}" mode="widthFix"/>
<image class="result-img" src="{{asyncPath}}" mode="widthFix"/>

  <button bindtap="saveSync">保存同步谱</button>
</view>

<view wx:if="{{asyncPath}}" class="section">
  <text>异步二维相关光谱</text>
  <image src="{{asyncPath}}" mode="widthFix" style="width:100%; margin-top:10px;"/>
  <button bindtap="saveAsync">保存异步谱</button>
</view>

</view>
